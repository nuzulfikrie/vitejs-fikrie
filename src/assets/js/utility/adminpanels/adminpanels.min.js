/*!
 * AdminPanels.js
 * Author: Copyright (c) 2017 Admindesigns 
 * Admin Panels was created solely for this theme and does not allow redistribution
 */
!function(e,n,a,l){e.fn.adminpanel=function(n){var l={grid:".admin-grid",mobile:!0,draggable:!1,preserveGrid:!0,onPanel:function(){console.log("callback:","onPanel")},onStart:function(){console.log("callback:","onStart")},onSave:function(){console.log("callback:","onSave")},onDrop:function(){console.log("callback:","onDrop")},onFinish:function(){console.log("callback:","onFinish")}},n=e.extend({},l,n),o=e("body"),t=e(this),s=(t.attr("id"),n.grid),i=n.draggable,r=n.mobile,c=(n.preserveGrid,t.find(".panel")),p="panel-settings_"+location.pathname,d="panel-positions_"+location.pathname,f=localStorage.getItem(p),u=localStorage.getItem(d);t.on("click",".panel-controls",function(a){if("a"==a.target.tagName.toLowerCase()){if(a.preventDefault(),e("body.ui-drag-active").length)return;h.controlHandlers.call(a.target,n)}});var h={init:function(n){e(this);"function"==typeof n.onStart&&n.onStart(),u?h.setPositions():localStorage.setItem(d,h.findPositions()),f||localStorage.setItem(p,h.modifySettings()),e(s).each(function(n,a){e(a).attr("id","grid-"+n),e(a).hasClass("sort-disable")||e(a).append('<div class="panel preserve-grid"></div>')}),h.applySettings(),h.createControls(n),"function"==typeof n.onFinish&&n.onFinish(),!0===i&&setTimeout(function(){t.sortable({items:e(s).find('.panel:not(".sort-disable")'),connectWith:".admin-grid",containment:"#content",handle:".panel-heading",opacity:1,delay:100,revert:100,scroll:!0,placeholder:"panel-placeholder",forcePlaceholderSize:!0,forceHelperSize:!0,create:function(){},start:function(n,a){e("body").addClass("ui-drag-active"),a.placeholder.height(a.helper.outerHeight()-4)},beforeStop:function(){"function"==typeof n.onDrop&&n.onDrop()},stop:function(){o.removeClass("ui-drag-active")},update:function(e,a){h.toggleLoader(),h.updatePositions(n)}})},0)},createControls:function(n){var a={panelLoader:'<a href="#" class="panel-control-loader"></a>',panelRemove:'<a href="#" class="panel-control-remove"></a>',panelCollapse:'<a href="#" class="panel-control-collapse"></a>',panelTitle:'<a href="#" class="panel-control-title"></a>',panelColor:'<a href="#" class="panel-control-color"></a>',panelFullscreen:'<a href="#" class="panel-control-fullscreen"></a>'};c.each(function(n,l){var o=e(l),t="",s=o.data();e.each(a,function(e,n){1==s[e]?t+=n:0==s[e]||s[e]?0!=s[e]&&"panelColor"==e&&(t+=n):t+=n});var i=o.children(".panel-heading");e('<span class="panel-controls"></span>').append(t).appendTo(i),e('<div class="panel-controls-btn btn btn-default btn-gradient btn-lg"><span class="fa fa-bars"></span></div>').appendTo(i).on("click",function(){i.toggleClass("panel-controls-open")})})},createMobileControls:function(n){c.find(".panel-controls");var a={};c.each(function(n,l){var o=e(l),t=o.attr("id"),s=o.children(".panel-heading"),i=s.children(".panel-controls").width()+s.children(".panel-title").width();a[t]=i}),e.each(a,function(n,a){var l=e("#"+n),o=(l.width(),l.find(".panel-controls")),t=l.children(".panel-heading");if(1==r){t.addClass("mobile-controls");e('<div class="panel-controls-btn btn btn-default btn-gradient btn-lg"><span class="fa fa-bars"></span></div>').insertBefore(o).on("click",function(){t.toggleClass("panel-controls-open")})}})},controlHandlers:function(l){var s=e(this),r=(s.attr("class"),s.parents(".panel")),c=r.children(".panel-heading"),p=r.find(".panel-title");e(this).hasClass("panel-control-collapse")&&(r.toggleClass("panel-collapsed"),r.children(".panel-body, .panel-menu, .panel-footer").slideToggle("fast",function(){h.updateSettings(n)})),e(this).hasClass("panel-control-title")&&function(){var e=function(){var e=r.find(".panel-editbox");e.slideToggle("fast",function(){r.toggleClass("panel-editbox-open"),r.hasClass("panel-editbox-open")||(p.text(e.children("input").val()),h.updateSettings(n))})};if(r.find(".panel-editbox").length)e();else{var a='<div class="panel-editbox"><input type="text" class="form-control" value="'+p.text()+'"></div>';c.after(a);var l=r.find(".panel-editbox");l.children("input").on("keyup",function(){p.text(l.children("input").val())}),l.children("input").on("keypress",function(n){13==n.which&&e()}),e()}}(),e(this).hasClass("panel-control-color")&&function(){r.find(".panel-colorbox").length||c.after('<div class="panel-colorbox"> <span class="bg-white-remove" data-panel-color="panel-unstyled"></span> <span class="bg-white" data-panel-color="panel-default"></span> <span class="bg-primary" data-panel-color="panel-primary"></span> <span class="bg-info" data-panel-color="panel-info"></span> <span class="bg-success" data-panel-color="panel-success"></span> <span class="bg-warning" data-panel-color="panel-warning"></span> <span class="bg-danger" data-panel-color="panel-danger"></span> <span class="bg-alert" data-panel-color="panel-alert"></span> <span class="bg-system" data-panel-color="panel-system"></span> <span class="bg-dark" data-panel-color="panel-dark"></span> </div>');var a=r.find(".panel-colorbox");a.on("click","> span",function(a){var l=e(this).data("panel-color");r.removeClass("panel-unstyled panel-primary panel-info panel-success panel-warning panel-danger panel-alert panel-system panel-dark panel-default panel-white").addClass(l).data("panel-color",l),h.updateSettings(n)}),a.slideToggle("fast",function(){r.toggleClass("panel-colorbox-open")})}(),e(this).hasClass("panel-control-fullscreen")&&function(){function n(){o.removeClass("panel-fullscreen-active"),r.removeClass("panel-fullscreen"),!0===i&&t.sortable("enable"),e(a).unbind("keydown.request_fullscreen")}e("[data-toggle=popover]").popover("hide"),c.find(".panel-controls").removeClass("panel-controls-open"),o.hasClass("panel-fullscreen-active")?n():(o.addClass("panel-fullscreen-active"),r.addClass("panel-fullscreen"),!0===i&&t.sortable("disable"),e(a).on("keydown.request_fullscreen",function(e){27==e.keyCode&&n()}))}(),e(this).hasClass("panel-control-remove")&&(bootbox.confirm?bootbox.confirm("Are You Sure?!",function(e){e&&setTimeout(function(){r.addClass("panel-removed").hide(),h.updateSettings(n)},200)}):(r.addClass("panel-removed").hide(),h.updateSettings(n))),e(this).hasClass("panel-control-callback")&&"function"==typeof n.onPanel&&n.onPanel(),e(this).hasClass("panel-control-expose"),e(this).hasClass("panel-control-dockable")||e(this).hasClass("panel-control-loader")||h.toggleLoader.call(this)},applySettings:function(n){var a=localStorage.getItem(p),l=JSON.parse(a);e.each(l,function(n,a){e.each(a,function(n,a){var l=a.id,o=a.title,t=a.collapsed,s=a.hidden,i=a.color,r=e("#"+l);o&&r.children(".panel-heading").find(".panel-title").text(o),i&&r.removeClass("panel-primary panel-success panel-info panel-warning panel-danger panel-alert panel-system panel-dark panel-default").addClass(i).data("panel-color",i),t&&r.addClass("panel-collapsed").children(".panel-body, .panel-menu, .panel-footer").hide(),s&&r.removeClass("hidden").addClass("panel-hidden").hide()})})},modifySettings:function(n){var a=[];return c.each(function(n,l){var o=e(l),t={},s=(o.attr("id"),o.children(".panel-heading").find(".panel-title").text(),o.hasClass("panel-collapsed"),o.is(":hidden"),o.data("panel-color"));t.id=o.attr("id"),t.title=o.children(".panel-heading").find(".panel-title").text(),t.collapsed=o.hasClass("panel-collapsed")?1:0,t.hidden=o.is(":hidden")?1:0,t.color=s||null,a.push({panel:t})}),JSON.stringify(a)},findPositions:function(n){var a=[];return t.find(s).each(function(n,l){var o=e(l).find(".panel"),t=[];e(l).attr("id","grid-"+n),o.each(function(n,a){var l=e(a).attr("id");t.push(l)}),a[n]=t}),JSON.stringify(a)},setPositions:function(n){var a=localStorage.getItem(d),l=JSON.parse(a);e(s).each(function(n,a){e.each(l[n],function(n,l){e("#"+l).appendTo(a)})})},updatePositions:function(e){localStorage.setItem(d,h.findPositions()),"function"==typeof e.onSave&&e.onSave()},updateSettings:function(e){localStorage.setItem(p,h.modifySettings()),"function"==typeof e.onSave&&e.onSave()},toggleLoader:function(n){var a=e(this).parents(".panel");a.addClass("panel-loader-active"),setTimeout(function(){a.removeClass("panel-loader-active")},650)}};return this.each(function(){h.init.call(t,n)})}}(jQuery,window,document);